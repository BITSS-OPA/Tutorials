## Deploy your OPA Project on Binder

### Overview

This tutorial is meant to help you deploy your OPA Project on Binder so that readers can play with our code in a web-based RStudio interface.

It only includes instruction steps to create a Binder for an existing project. To learn more about how to create a Binder project from the beginning, read [here](https://github.com/alan-turing-institute/the-turing-way/blob/master/workshops/boost-research-reproducibility-binder/workshop-presentations/zero-to-binder-r.md).

### Local Setup

**1. Add `runtime.txt`**  
* Run `install.packages("holepunch")` in your console
  + In R, we can use package holepunch to binderise our projects! The package provides functionality to create the necessary files and automatically configure them with the required information. All files created with holepunch are store in a hidden .binder/ directory and Binder knows to use those files to build your environment. ([Copied](https://github.com/alan-turing-institute/the-turing-way/blob/master/workshops/boost-research-reproducibility-binder/workshop-presentations/zero-to-binder-r.md) from Alan Turing Institute)
* Set your working directory to the big overarching folder (e.g. opa-deworming) by running `setwd(filepath_to_opa-deworming)`
  + This is crucial because if you don't set it to the correct directory, you'll be writing files in the wrong directory. We need those files to deploy on Binder seamlessly.
* Run in console `holepunch::write_runtime()` to create a `runtime.txt` in the `.binder/`, configured with today's date.

**2. Add `install.R`**
* In `.binder`  folder, create a R script as below and include all the packages the OPA project uses in both dynamic document and shiny app:
> `install.packages("dplyr")`  
`install.packages("ggplot2")`  
...

This file is to install the packages onto the RStudio interface hosted on binder. So even if the OPA project code does have `install.packages()` embedded in the Rmd file, we still need it.

Note that here if you use the `install.R` generated by running `holepunch::write_install()`. You might run into some issues when you are actually deploying it on binder websites.

## Binder Setup
**1. Commit and push your updates to GitHub repo**

Since we are building our binder project from GitHub, we need to make sure our GitHub is in sync with our local changes first.

**2. Launch our Binder Site**
* Go to https://mybinder.org
* Type the URL of the OPA project GitHub repo into the "GitHub repo or URL" box. It should look like this:
> https://github.com/BITSS-OPA/project-name

* As you type, the webpage generates a link in the "Copy the URL below..." box It should look like this:
> https://mybinder.org/v2/gh/BITSS-OPA/repo-name/HEAD

* Copy it, open a new browser tab and visit that URL.
  + This will take a really long time if you are launching it the first time. You will see a Jupyter Notebook interface if everything ran smoothly.

## Open RStudio
* On Jupyter Interface, you should see "New" on top right corner. Click "New" and then click "RStudio".
* From there, you can use RStudio like you normally do.

## Share the link

1. Share the URL you got from https://mybinder.org for the Jupyter Notebook Interface.
2. Share RStudio interface with the link:
> https://mybinder.org/v2/gh/BITSS-OPA/repo-name/master?urlpath=rstudio

3. Share Shiny App interface with the link:
> https://mybinder.org/v2/gh/BITSS-OPA/repo-name/master?urlpath=shiny/code/shiny_app

After you put in the `urlpath=shiny`, the path following that is the specific folder you use to store your  `ui.R` and `server.R`
